<VirtualHost *:443>
    ServerName hobunror.nl
    ServerAlias www.hobunror.nl
    DocumentRoot /var/www/hobunror
    Alias /allsky /var/www/hobunror/allsky
    Alias /arda /var/www/hobunror/arda/project/dist
    Alias /deepsky /var/www/hobunror/deepsky

    SSLEngine on
    SSLCertificateFile /etc/letsencrypt/live/hobunror.nl/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/hobunror.nl/privkey.pem
    Include /etc/letsencrypt/options-ssl-apache.conf

    ProxyPreserveHost On
    ProxyPass /arda/api http://127.0.0.1:3000/api
    ProxyPassReverse /arda/api http://127.0.0.1:3000/api
    ProxyPass /deepsky/api http://127.0.0.1:5000/api
    ProxyPassReverse /deepsky/api http://127.0.0.1:5000/api

    # Arda configuration
    <Directory /var/www/hobunror/arda/project/dist>
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
        DirectoryIndex index.html
        RewriteEngine On
        RewriteCond %{REQUEST_URI} !^/arda/api
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteRule ^/arda.* /arda/index.html [L]
    </Directory>

    <Directory /var/www/hobunror/deepsky>
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
        DirectoryIndex index.html
        RewriteEngine On
        RewriteBase /deepsky/
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteRule ^ /deepsky/index.html [L]
    </Directory>
